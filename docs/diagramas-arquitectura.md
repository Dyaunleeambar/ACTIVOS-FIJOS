# Diagramas de Arquitectura - Sistema de Gestión de Medios Informáticos

## 🏗️ **Diagramas de Arquitectura Detallados**

### **1. Arquitectura General del Sistema**

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                           CLIENTE WEB                                      │
│  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐           │
│  │   Login Page    │  │  Dashboard      │  │  Reports Page   │           │
│  │                 │  │                 │  │                 │           │
│  │ HTML/CSS/JS     │  │ HTML/CSS/JS     │  │ HTML/CSS/JS     │           │
│  └─────────────────┘  └─────────────────┘  └─────────────────┘           │
│                                                                           │
│  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐           │
│  │  Inventory      │  │  Assignment     │  │  Security       │           │
│  │  Page           │  │  Page           │  │  Page           │           │
│  │                 │  │                 │  │                 │           │
│  │ HTML/CSS/JS     │  │ HTML/CSS/JS     │  │ HTML/CSS/JS     │           │
│  └─────────────────┘  └─────────────────┘  └─────────────────┘           │
└─────────────────────────────────────────────────────────────────────────────┘
                                    │
                                    ▼
┌─────────────────────────────────────────────────────────────────────────────┐
│                           SERVIDOR WEB                                     │
│  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐           │
│  │   Nginx         │  │   Node.js       │  │   Express.js    │           │
│  │   (Reverse      │  │   (Runtime)     │  │   (Framework)   │           │
│  │    Proxy)       │  │                 │  │                 │           │
│  └─────────────────┘  └─────────────────┘  └─────────────────┘           │
│                                                                           │
│  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐           │
│  │   Routes        │  │   Controllers   │  │   Services      │           │
│  │   (API Endpoints)│  │   (Business     │  │   (Business     │           │
│  │                 │  │    Logic)       │  │    Logic)       │           │
│  └─────────────────┘  └─────────────────┘  └─────────────────┘           │
│                                                                           │
│  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐           │
│  │   Middleware    │  │   Validation    │  │   Authentication│           │
│  │   (Security,    │  │   (Input        │  │   (JWT, Roles)  │           │
│  │    Logging)     │  │    Validation)  │  │                 │           │
│  └─────────────────┘  └─────────────────┘  └─────────────────┘           │
└─────────────────────────────────────────────────────────────────────────────┘
                                    │
                                    ▼
┌─────────────────────────────────────────────────────────────────────────────┐
│                        BASE DE DATOS                                      │
│  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐           │
│  │   MySQL         │  │   Tables        │  │   Indexes       │           │
│  │   (Database     │  │   (Data         │  │   (Performance  │           │
│  │    Engine)      │  │    Storage)     │  │    Optimization)│           │
│  └─────────────────┘  └─────────────────┘  └─────────────────┘           │
│                                                                           │
│  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐           │
│  │   Views         │  │   Stored        │  │   Triggers      │           │
│  │   (Reports)     │  │   Procedures    │  │   (Audit Trail) │           │
│  │                 │  │   (Business     │  │                 │           │
│  │                 │  │    Logic)       │  │                 │           │
│  └─────────────────┘  └─────────────────┘  └─────────────────┘           │
└─────────────────────────────────────────────────────────────────────────────┘
```

### **2. Flujo de Datos del Sistema**

```
┌─────────────┐    ┌─────────────┐    ┌─────────────┐    ┌─────────────┐
│   Cliente   │───►│   Servidor  │───►│   Base de   │───►│   Respuesta │
│   Web       │    │   Web       │    │   Datos     │    │   al Cliente│
└─────────────┘    └─────────────┘    └─────────────┘    └─────────────┘
       │                   │                   │                   │
       │                   │                   │                   │
       ▼                   ▼                   ▼                   ▼
┌─────────────┐    ┌─────────────┐    ┌─────────────┐    ┌─────────────┐
│ 1. Request  │    │ 2. Validate │    │ 3. Query    │    │ 4. Response │
│   HTTP      │    │   & Process │    │   Database  │    │   JSON      │
└─────────────┘    └─────────────┘    └─────────────┘    └─────────────┘
       │                   │                   │                   │
       │                   │                   │                   │
       ▼                   ▼                   ▼                   ▼
┌─────────────┐    ┌─────────────┐    ┌─────────────┐    ┌─────────────┐
│ 5. Display  │    │ 6. Business │    │ 7. Data     │    │ 8. Update   │
│   Results   │    │   Logic     │    │   Storage   │    │   UI        │
└─────────────┘    └─────────────┘    └─────────────┘    └─────────────┘
```

### **3. Arquitectura de Seguridad**

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                           LAYER 1: CLIENT                                 │
│  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐           │
│  │   Input         │  │   Form          │  │   Client-side   │           │
│  │   Validation    │  │   Validation    │  │   Validation    │           │
│  │   (HTML5)       │  │   (JavaScript)  │  │   (Sanitization)│           │
│  └─────────────────┘  └─────────────────┘  └─────────────────┘           │
└─────────────────────────────────────────────────────────────────────────────┘
                                    │
                                    ▼
┌─────────────────────────────────────────────────────────────────────────────┐
│                           LAYER 2: NETWORK                                │
│  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐           │
│  │   HTTPS         │  │   CORS          │  │   Rate Limiting │           │
│  │   (SSL/TLS)     │  │   (Headers)     │  │   (Protection)  │           │
│  │                 │  │                 │  │                 │           │
│  └─────────────────┘  └─────────────────┘  └─────────────────┘           │
└─────────────────────────────────────────────────────────────────────────────┘
                                    │
                                    ▼
┌─────────────────────────────────────────────────────────────────────────────┐
│                           LAYER 3: SERVER                                 │
│  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐           │
│  │   JWT           │  │   Role-based    │  │   Input         │           │
│  │   Authentication│  │   Authorization  │  │   Validation    │           │
│  │   (Tokens)      │  │   (RBAC)        │  │   (Server-side) │           │
│  └─────────────────┘  └─────────────────┘  └─────────────────┘           │
│                                                                           │
│  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐           │
│  │   Password      │  │   Data          │  │   SQL           │           │
│  │   Hashing       │  │   Encryption    │  │   Injection     │           │
│  │   (bcrypt)      │  │   (AES)         │  │   Protection    │           │
│  └─────────────────┘  └─────────────────┘  └─────────────────┘           │
└─────────────────────────────────────────────────────────────────────────────┘
                                    │
                                    ▼
┌─────────────────────────────────────────────────────────────────────────────┐
│                           LAYER 4: DATABASE                               │
│  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐           │
│  │   User          │  │   Data          │  │   Audit         │           │
│  │   Permissions   │  │   Backup        │  │   Logging       │           │
│  │   (MySQL)       │  │   (Encrypted)   │  │   (Triggers)    │           │
│  └─────────────────┘  └─────────────────┘  └─────────────────┘           │
└─────────────────────────────────────────────────────────────────────────────┘
```

### **4. Arquitectura de Módulos**

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                        SISTEMA PRINCIPAL                                  │
├─────────────────────────────────────────────────────────────────────────────┤
│  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐           │
│  │   Módulo de     │  │   Módulo de     │  │   Módulo de     │           │
│  │   Inventario    │  │   Asignaciones  │  │   Seguridad     │           │
│  │                 │  │                 │  │                 │           │
│  │ • Registro      │  │ • Asignación    │  │ • Datos de      │           │
│  │ • Estados       │  │ • Historial     │  │   Seguridad     │           │
│  │ • Movimientos   │  │ • Transferencias│  │ • Usuarios      │           │
│  │ • Tipos         │  │ • Actas         │  │ • Contraseñas   │           │
│  └─────────────────┘  └─────────────────┘  └─────────────────┘           │
│                                                                           │
│  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐           │
│  │   Módulo de     │  │   Módulo de     │  │   Módulo de     │           │
│  │   Reportes      │  │   Propuestas    │  │   Autenticación │           │
│  │                 │  │   de Baja       │  │                 │           │
│  │ • Inventario    │  │ • Creación      │  │ • Login         │           │
│  │ • Movimientos   │  │ • Aprobación    │  │ • JWT           │           │
│  │ • Por Empleado  │  │ • Checklist     │  │ • Roles         │           │
│  │ • Por Tipo      │  │ • Reportes      │  │ • Permisos      │           │
│  └─────────────────┘  └─────────────────┘  └─────────────────┘           │
└─────────────────────────────────────────────────────────────────────────────┘
                                    │
                                    ▼
┌─────────────────────────────────────────────────────────────────────────────┐
│                        SERVICIOS COMPARTIDOS                              │
├─────────────────────────────────────────────────────────────────────────────┤
│  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐           │
│  │   Servicio de   │  │   Servicio de   │  │   Servicio de   │           │
│  │   Validación    │  │   Logging       │  │   Exportación   │           │
│  │                 │  │                 │  │                 │           │
│  │ • Input         │  │ • Errores       │  │ • PDF           │           │
│  │ • Formato       │  │ • Acciones      │  │ • Excel         │           │
│  │ • Negocio       │  │ • Auditoría     │  │ • Reportes      │           │
│  └─────────────────┘  └─────────────────┘  └─────────────────┘           │
│                                                                           │
│  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐           │
│  │   Servicio de   │  │   Servicio de   │  │   Servicio de   │           │
│  │   Base de       │  │   Encriptación  │  │   Notificaciones│           │
│  │   Datos         │  │                 │  │                 │           │
│  │                 │  │ • Passwords     │  │ • Email         │           │
│  │ • Conexión      │  │ • Datos         │  │ • SMS           │           │
│  │ • Queries       │  │   Sensibles     │  │ • Alertas       │           │
│  │ • Transacciones │  │ • Tokens        │  │                 │           │
│  └─────────────────┘  └─────────────────┘  └─────────────────┘           │
└─────────────────────────────────────────────────────────────────────────────┘
```

### **5. Flujo de Autenticación**

```
┌─────────────┐    ┌─────────────┐    ┌─────────────┐    ┌─────────────┐
│   Usuario   │───►│   Login     │───►│   Validar   │───►│   Generar    │
│   Ingresa   │    │   Form      │    │   Credenciales│  │   JWT Token │
│   Credenciales│   │             │    │             │    │             │
└─────────────┘    └─────────────┘    └─────────────┘    └─────────────┘
       │                   │                   │                   │
       │                   │                   │                   │
       ▼                   ▼                   ▼                   ▼
┌─────────────┐    ┌─────────────┐    ┌─────────────┐    ┌─────────────┐
│ 1. Username │    │ 2. Enviar   │    │ 3. Verificar│    │ 4. Crear     │
│   Password  │    │   Request   │    │   en BD     │    │   Token      │
└─────────────┘    └─────────────┘    └─────────────┘    └─────────────┘
       │                   │                   │                   │
       │                   │                   │                   │
       ▼                   ▼                   ▼                   ▼
┌─────────────┐    ┌─────────────┐    ┌─────────────┐    ┌─────────────┐
│ 5. Recibir  │    │ 6. Almacenar│    │ 7. Redirigir│    │ 8. Acceder  │
│   Token     │    │   en Local  │    │   a App     │    │   a Sistema │
└─────────────┘    └─────────────┘    └─────────────┘    └─────────────┘
```

### **6. Flujo de Gestión de Equipos**

```
┌─────────────┐    ┌─────────────┐    ┌─────────────┐    ┌─────────────┐
│   Usuario   │───►│   Formulario│───►│   Validar   │───►│   Guardar   │
│   Registra  │    │   de        │    │   Datos     │    │   en BD     │
│   Equipo    │    │   Equipo    │    │             │    │             │
└─────────────┘    └─────────────┘    └─────────────┘    └─────────────┘
       │                   │                   │                   │
       │                   │                   │                   │
       ▼                   ▼                   ▼                   ▼
┌─────────────┐    ┌─────────────┐    ┌─────────────┐    ┌─────────────┐
│ 1. Llenar   │    │ 2. Enviar   │    │ 3. Validar  │    │ 4. Crear    │
│   Campos    │    │   Request   │    │   Formato   │    │   Registro  │
└─────────────┘    └─────────────┘    └─────────────┘    └─────────────┘
       │                   │                   │                   │
       │                   │                   │                   │
       ▼                   ▼                   ▼                   ▼
┌─────────────┐    ┌─────────────┐    ┌─────────────┐    ┌─────────────┐
│ 5. Mostrar  │    │ 6. Actualizar│   │ 7. Notificar│    │ 8. Registrar│
│   Éxito     │    │   Lista     │    │   Usuario   │    │   Log       │
└─────────────┘    └─────────────┘    └─────────────┘    └─────────────┘
```

### **7. Flujo de Asignación de Equipos**

```
┌─────────────┐    ┌─────────────┐    ┌─────────────┐    ┌─────────────┐
│   IT        │───►│   Seleccionar│───►│   Validar   │───►│   Crear     │
│   Central   │    │   Equipo y  │    │   Disponibilidad│  │   Asignación│
│   Asigna    │    │   Empleado  │    │             │    │             │
└─────────────┘    └─────────────┘    └─────────────┘    └─────────────┘
       │                   │                   │                   │
       │                   │                   │                   │
       ▼                   ▼                   ▼                   ▼
┌─────────────┐    ┌─────────────┐    ┌─────────────┐    ┌─────────────┐
│ 1. Acceder  │    │ 2. Buscar   │    │ 3. Verificar│    │ 4. Registrar│
│   Sistema   │    │   Equipo    │    │   Estado    │    │   en BD     │
└─────────────┘    └─────────────┘    └─────────────┘    └─────────────┘
       │                   │                   │                   │
       │                   │                   │                   │
       ▼                   ▼                   ▼                   ▼
┌─────────────┐    ┌─────────────┐    ┌─────────────┐    ┌─────────────┐
│ 5. Generar  │    │ 6. Actualizar│   │ 7. Notificar│    │ 8. Registrar│
│   Acta      │    │   Estado    │    │   Empleado  │    │   Log       │
└─────────────┘    └─────────────┘    └─────────────┘    └─────────────┘
```

### **8. Arquitectura de Despliegue**

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                           INTERNET                                        │
└─────────────────────────────────────────────────────────────────────────────┘
                                    │
                                    ▼
┌─────────────────────────────────────────────────────────────────────────────┐
│                        LOAD BALANCER                                      │
│  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐           │
│  │   Nginx         │  │   SSL/TLS       │  │   Rate Limiting │           │
│  │   (Reverse      │  │   Certificate   │  │   & Security    │           │
│  │    Proxy)       │  │                 │  │   Headers       │           │
│  └─────────────────┘  └─────────────────┘  └─────────────────┘           │
└─────────────────────────────────────────────────────────────────────────────┘
                                    │
                                    ▼
┌─────────────────────────────────────────────────────────────────────────────┐
│                        APPLICATION SERVER                                 │
│  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐           │
│  │   Node.js       │  │   PM2           │  │   Express.js    │           │
│  │   (Runtime)     │  │   (Process      │  │   (Framework)   │           │
│  │                 │  │    Manager)     │  │                 │           │
│  └─────────────────┘  └─────────────────┘  └─────────────────┘           │
│                                                                           │
│  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐           │
│  │   Static Files  │  │   API Routes    │  │   Middleware    │           │
│  │   (HTML/CSS/JS) │  │   (RESTful)     │  │   (Security)    │           │
│  │                 │  │                 │  │                 │           │
│  └─────────────────┘  └─────────────────┘  └─────────────────┘           │
└─────────────────────────────────────────────────────────────────────────────┘
                                    │
                                    ▼
┌─────────────────────────────────────────────────────────────────────────────┐
│                        DATABASE SERVER                                    │
│  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐           │
│  │   MySQL         │  │   Backup        │  │   Monitoring    │           │
│  │   (Database)    │  │   System        │  │   Tools         │           │
│  │                 │  │                 │  │                 │           │
│  └─────────────────┘  └─────────────────┘  └─────────────────┘           │
│                                                                           │
│  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐           │
│  │   Replication   │  │   Indexes       │  │   Stored        │           │
│  │   (Master-Slave)│  │   (Performance) │  │   Procedures    │           │
│  │                 │  │                 │  │                 │           │
│  └─────────────────┘  └─────────────────┘  └─────────────────┘           │
└─────────────────────────────────────────────────────────────────────────────┘
```

### **9. Diagrama de Componentes**

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                        FRONTEND COMPONENTS                               │
├─────────────────────────────────────────────────────────────────────────────┤
│  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐           │
│  │   Auth          │  │   Dashboard     │  │   Navigation    │           │
│  │   Component     │  │   Component     │  │   Component     │           │
│  │                 │  │                 │  │                 │           │
│  │ • Login         │  │ • Overview      │  │ • Menu          │           │
│  │ • Logout        │  │ • Stats         │  │ • Breadcrumbs   │           │
│  │ • Profile       │  │ • Quick Actions│  │ • Search        │           │
│  └─────────────────┘  └─────────────────┘  └─────────────────┘           │
│                                                                           │
│  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐           │
│  │   Equipment     │  │   Assignment    │  │   Reports       │           │
│  │   Component     │  │   Component     │  │   Component     │           │
│  │                 │  │                 │  │                 │           │
│  │ • List          │  │ • Assign        │  │ • Generate      │           │
│  │ • Form          │  │ • Transfer      │  │ • Export        │           │
│  │ • Details       │  │ • History       │  │ • Filter        │           │
│  └─────────────────┘  └─────────────────┘  └─────────────────┘           │
└─────────────────────────────────────────────────────────────────────────────┘
                                    │
                                    ▼
┌─────────────────────────────────────────────────────────────────────────────┐
│                        BACKEND COMPONENTS                                │
├─────────────────────────────────────────────────────────────────────────────┤
│  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐           │
│  │   Auth          │  │   Equipment     │  │   Assignment    │           │
│  │   Controller    │  │   Controller    │  │   Controller    │           │
│  │                 │  │                 │  │                 │           │
│  │ • Login         │  │ • CRUD          │  │ • Assign        │           │
│  │ • JWT           │  │ • Search        │  │ • Transfer      │           │
│  │ • Roles         │  │ • Filter        │  │ • History       │           │
│  └─────────────────┘  └─────────────────┘  └─────────────────┘           │
│                                                                           │
│  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐           │
│  │   Reports       │  │   Security      │  │   Disposal      │           │
│  │   Controller    │  │   Controller    │  │   Controller    │           │
│  │                 │  │                 │  │                 │           │
│  │ • Generate      │  │ • Credentials   │  │ • Propose       │           │
│  │ • Export        │  │ • Access        │  │ • Approve       │           │
│  │ • Filter        │  │ • Encrypt       │  │ • Report        │           │
│  └─────────────────┘  └─────────────────┘  └─────────────────┘           │
└─────────────────────────────────────────────────────────────────────────────┘
```

### **10. Diagrama de Base de Datos**

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                        DATABASE SCHEMA                                   │
├─────────────────────────────────────────────────────────────────────────────┤
│  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐           │
│  │   users         │  │   states        │  │   equipment     │           │
│  │                 │  │                 │  │                 │           │
│  │ • id (PK)       │  │ • id (PK)       │  │ • id (PK)       │           │
│  │ • username      │  │ • name          │  │ • inventory_number│         │
│  │ • password      │  │ • code          │  │ • name          │           │
│  │ • email         │  │ • is_active     │  │ • type          │           │
│  │ • full_name     │  │                 │  │ • brand         │           │
│  │ • role          │  │                 │  │ • model         │           │
│  │ • state_id (FK) │  │                 │  │ • specifications│           │
│  │ • is_active     │  │                 │  │ • status        │           │
│  │ • created_at    │  │                 │  │ • state_id (FK) │           │
│  │ • updated_at    │  │                 │  │ • assigned_to (FK)│         │
│  └─────────────────┘  └─────────────────┘  └─────────────────┘           │
│                                                                           │
│  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐           │
│  │   assignments   │  │   movements     │  │   security_data │           │
│  │                 │  │                 │  │                 │           │
│  │ • id (PK)       │  │ • id (PK)       │  │ • id (PK)       │           │
│  │ • equipment_id  │  │ • equipment_id  │  │ • equipment_id  │           │
│  │   (FK)          │  │   (FK)          │  │   (FK)          │           │
│  │ • user_id (FK)  │  │ • from_state_id │  │ • username      │           │
│  │ • assigned_by   │  │   (FK)          │  │ • password      │           │
│  │   (FK)          │  │ • to_state_id   │  │ • access_details│           │
│  │ • assigned_at   │  │   (FK)          │  │ • created_at    │           │
│  │ • returned_at   │  │ • from_location │  │ • updated_at    │           │
│  │ • notes         │  │ • to_location   │  │                 │           │
│  │                 │  │ • moved_by (FK) │  │                 │           │
│  │                 │  │ • moved_at      │  │                 │           │
│  │                 │  │ • reason        │  │                 │           │
│  └─────────────────┘  └─────────────────┘  └─────────────────┘           │
│                                                                           │
│  ┌─────────────────┐                                                    │
│  │   disposal_proposals│                                                │
│  │                 │                                                    │
│  │ • id (PK)       │                                                    │
│  │ • equipment_id  │                                                    │
│  │   (FK)          │                                                    │
│  │ • proposed_by   │                                                    │
│  │   (FK)          │                                                    │
│  │ • reason        │                                                    │
│  │ • description   │                                                    │
│  │ • status        │                                                    │
│  │ • approved_by   │                                                    │
│  │   (FK)          │                                                    │
│  │ • approved_at   │                                                    │
│  │ • created_at    │                                                    │
│  └─────────────────┘                                                    │
└─────────────────────────────────────────────────────────────────────────────┘
```

---

*Documento de Diagramas de Arquitectura - Versión 1.0* 